decisions = {
	dwse_hatch_dragon = {
		is_high_prio = yes
		potential = {
			lf_races_dwse_active = yes
			has_artifact = dwse_dragon_egg
		}
		allow = {
			NOT = { is_incapable = yes }
			prisoner = no
			has_artifact = dwse_dragon_egg
			OR = {
				is_landed = yes
				mercenary = yes
			}
		}
		effect = {
			narrative_event = { id = dwseom.800 } #Self target
		}
		ai_will_do = {
			factor = 1 # 100%
		}		
	}

}
offmap_decisions = {
	dwse_offer_slave = {
		only_playable = yes
		button_name = dwse_gifts
		
		third_party_filter = home_court
		ai_third_party_filter = home_court
		third_party = FROM
		ai_check_interval = 36
		show_third_party_potential = yes

		potential = {
			is_offmap_tag = offmap_dwse	
		}
	
		from_potential = {
			lf_races_dwse_active = yes
			ai = no
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			FROM = {
				show_scope_change = no
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
		}
		
		third_party_potential = {
			show_only_failed_conditions = yes
			FROMFROM = {
				NOT = { is_incapable = yes }
				show_scope_change = no
				ai = yes
				is_adult = yes
				is_enslaved = yes
				is_heir = no
				NOT = { trait = lf_ghost }
				NOT = { is_landed = yes }
				custom_tooltip = {
					text = is_not_incapable_inbred_or_imbecile_tt
					NOT = { trait = incapable }
					NOT = { trait = inbred }
					NOT = { trait = imbecile }
				}
				custom_tooltip = {
					text = is_not_maimed_or_infirm_tt
					NOT = { trait = maimed }
					NOT = { trait = infirm }
				}				
			}
		}

		third_party_allow = {
			show_only_failed_conditions = yes
			FROMFROM = {
				is_ill = no
				custom_tooltip = {
					text = is_not_wounded_severely_injured_tt
					NOT = { trait = wounded }
					NOT = { trait = severely_injured }
				}
				custom_tooltip = {
					text = lf_too_important_for_dragons_tt
					NOT = { has_character_flag = lf_too_important_for_dragons }
				}
				
				is_inaccessible_trigger = no
			}
		}
		
		third_party_score = {
			factor = 100
			
			additive_modifier = {
				value = -60
				FROM = {
					show_scope_change = no
					NOR = { 
						capital_holding = {
							OR = {
								has_building = dwse_dragon_roost_castle
								has_building = dwse_dragon_roost_tribal
								has_building = dwse_dragon_roost_nomad
							}
						}
						family_palace = {
							has_building = dwse_dragon_roost_palace
						}
 					}
				}
			}

			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					martial = 12					
					hidden_trigger = {
						NOT = { martial = 14 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					martial = 14					
					hidden_trigger = {
						NOT = { martial = 16 }
					}
				}
			}
			additive_modifier = {
				value = 60
				FROMFROM = {
					show_scope_change = no 
					martial = 16				
					hidden_trigger = {
						NOT = { martial = 18 }
					}
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					diplomacy = 8					
					hidden_trigger = {
						NOT = { diplomacy = 12 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					diplomacy = 12					
					hidden_trigger = {
						NOT = { diplomacy = 16 }
					}
				}
			}
			additive_modifier = {
				value = 75
				FROMFROM = { 
					show_scope_change = no
					diplomacy = 16				
					hidden_trigger = {
						NOT = { diplomacy = 20 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = { 
					show_scope_change = no
					diplomacy = 20
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					martial = 8					
					hidden_trigger = {
						NOT = { martial = 12 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					martial = 12					
					hidden_trigger = {
						NOT = { martial = 16 }
					}
				}
			}
			additive_modifier = {
				value = 75
				FROMFROM = { 
					show_scope_change = no
					martial = 16				
					hidden_trigger = {
						NOT = { martial = 20 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = { 
					show_scope_change = no
					martial = 20
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					stewardship = 8					
					hidden_trigger = {
						NOT = { stewardship = 12 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					stewardship = 12					
					hidden_trigger = {
						NOT = { stewardship = 16 }
					}
				}
			}
			additive_modifier = {
				value = 75
				FROMFROM = { 
					show_scope_change = no
					stewardship = 16				
					hidden_trigger = {
						NOT = { stewardship = 20 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = { 
					show_scope_change = no
					stewardship = 20
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					intrigue = 8					
					hidden_trigger = {
						NOT = { intrigue = 12 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					intrigue = 12					
					hidden_trigger = {
						NOT = { intrigue = 16 }
					}
				}
			}
			additive_modifier = {
				value = 75
				FROMFROM = { 
					show_scope_change = no
					intrigue = 16				
					hidden_trigger = {
						NOT = { intrigue = 20 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = { 
					show_scope_change = no
					intrigue = 20
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					learning = 8					
					hidden_trigger = {
						NOT = { learning = 12 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					learning = 12					
					hidden_trigger = {
						NOT = { learning = 16 }
					}
				}
			}
			additive_modifier = {
				value = 75
				FROMFROM = { 
					show_scope_change = no
					learning = 16				
					hidden_trigger = {
						NOT = { learning = 20 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = { 
					show_scope_change = no
					learning = 20
				}
			}
			additive_modifier = {
				value = 80
				FROMFROM = { 
					show_scope_change = no
					trait = fair
				}
			}
			additive_modifier = {
				value = -80
				FROMFROM = { 
					show_scope_change = no
					trait = ugly
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = genius
				}
			}
			additive_modifier = {
				value = 30
				FROMFROM = { 
					show_scope_change = no
					trait = quick
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = strong
				}
			}
			additive_modifier = {
				value = 30
				FROMFROM = {
					show_scope_change = no
					trait = robust
				}
			}
			additive_modifier = {
				value = 30
				FROMFROM = {
					show_scope_change = no
					trait = shrewd
				}
			}
			additive_modifier = {
				value = 30
				FROMFROM = {
					show_scope_change = no
					trait = charitable
				}
			}
			additive_modifier = {
				value = 30
				FROMFROM = {
					show_scope_change = no
					trait = gregarious
				}
			}
			additive_modifier = {
				value = 30
				FROMFROM = {
					show_scope_change = no
					trait = kind
				}
			}
			additive_modifier = {
				value = -50
				FROMFROM = {
					show_scope_change = no
					trait = lunatic
				}
			}
			additive_modifier = {
				value = 25
				custom_tooltip = {
					text = tribute_interaction_level3_education_tt
					FROMFROM = { 
						OR = {
							trait = intricate_webweaver
							trait = charismatic_negotiator
							trait = fortune_builder
							trait = skilled_tactician
							trait = scholarly_theologian
						}
					}
				}
			}
			additive_modifier = {
				value = 50
				custom_tooltip = {
					text = tribute_interaction_level4_education_tt
					FROMFROM = { 
						OR = {
							trait = elusive_shadow
							trait = grey_eminence
							trait = midas_touched
							trait = brilliant_strategist
							trait = mastermind_theologian
						}
					}
				}
			}

			additive_modifier = {
				value = 80
				FROMFROM = {
					show_scope_change = no 
					martial = 18				
					hidden_trigger = {
						NOT = { martial = 20 }
					}
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = {
					show_scope_change = no 
					martial = 20				
					hidden_trigger = {
						NOT = { martial = 22 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = {
					show_scope_change = no 
					martial = 22				
					hidden_trigger = {
						NOT = { martial = 24 }
					}
				}
			}
			additive_modifier = {
				value = 140
				FROMFROM = { 
					show_scope_change = no
					martial = 24
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = strategist
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = duelist
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					trait = hunter
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					trait = berserker
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = adventurer
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					trait = patient
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					trait = brave
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					trait = diligent
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = shieldmaiden
				}
			}
		
			additive_modifier = {
				value = 50
				FROMFROM = { 
					show_scope_change = no
					trait = sapper
				}
			}
			additive_modifier = {
				value = 50
				FROMFROM = { 
					show_scope_change = no
					trait = master_of_flame
				}
			}
			additive_modifier = {
				value = 50
				FROMFROM = { 
					show_scope_change = no
					trait = logistics_expert
				}
			}
			additive_modifier = {
				value = 50
				FROMFROM = { 
					show_scope_change = no
					trait = levy_coordinator
				}
			}
			
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = light_foot_leader
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = heavy_infantry_leader
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = cavalry_leader
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = inspiring_leader
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = trickster
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = organizer
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = defensive_leader
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = experimenter
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = flanker
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = aggressive_leader
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = siege_leader
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_neko = yes
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_futa = yes
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_elf = yes
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_orc = yes
				}
			}
						additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					is_female = yes
				}
			}

			additive_modifier = {
				value = 25
				custom_tooltip = {
					text = tribute_interaction_level3_education_tt
					FROMFROM = { 
						trait = skilled_tactician
					}
				}
			}
			additive_modifier = {
				value = 50
				custom_tooltip = {
					text = tribute_interaction_level4_education_tt
					FROMFROM = { 
						trait = brilliant_strategist
					}
				}
			}
			modifier = {
				factor = 2.0
				FROMFROM = { 
					show_scope_change = no
					liked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
			modifier = {
				factor = 0.5
				FROMFROM = {
					show_scope_change = no 
					disliked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					show_scope_change = no
					liked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
			modifier = {
				factor = 0.66
				FROM = {
					show_scope_change = no 
					disliked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
		}
	
		effect = {
			save_event_target_as = target_governor
			FROM = {
				sound_effect = china_grace_gain
				save_event_target_as = target_tribute_sender
			}
			FROMFROM = {
				save_event_target_as = person_sent_as_tribute
			}
			#if = {
			#	limit = {
			#		FROMFROM = { disliked_by_offmap = offmap_dwse}
			#	}
			#	custom_tooltip = { text = notification_china_dislike_tt }
			#}
			#if = {
			#	limit = {
			#		NOT = { FROMFROM = { disliked_by_offmap = offmap_dwse} }
			#		FROMFROM = { liked_by_offmap = offmap_dwse}
			#	}
			#	custom_tooltip = { text = notification_china_like_tt }
			#}
			FROM = {
				show_scope_change = no
				add_offmap_currency = {
					offmap = offmap_dwse
					value = local_third_party_score
				}
			}
			if = {
				limit = {
					FROMFROM = {
						has_character_flag = lf_personally_lf_enslaved
					}
				}
				FROM = {
					change_variable = { which = lf_slaves_sold value = 1 }
				}
			}
			
			# Like/Dislike effect description
			#################################
			if = {
				limit = {
					OR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
					NOR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
				}
				e_offmap_dwse_voice = {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = likes_tt }
					}
				}
			}
			
			if = {
				limit = {
					OR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
					NOR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
				}
				e_offmap_dwse_voice= {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = dislikes_tt }
					}
				}
			}
			if = {
				limit = {
					OR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
					OR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
				}
				e_offmap_dwse_voice= {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = likes_but_dislikes_tt }
					}
				}
			}
			#################################
			
			FROMFROM = {
				show_scope_change = no
				leave_court_for_forest_effect = yes
			}
		}
	

		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 0
				FROMFROM = { ai = no }
			}
		}
	}
	dwse_send_ambassador = {
		only_playable = yes
		button_name = dwse_gifts
		
		third_party_filter = home_court
		ai_third_party_filter = home_court
		third_party = FROM
		ai_check_interval = 100
		show_third_party_potential = yes

		potential = {
			is_offmap_tag = offmap_dwse	
		}
	
		from_potential = {
			lf_races_dwse_active = yes
			NOT = { is_incapable = yes }
			NOR = {
				trait = dwse_dragon_adult
				has_minor_title = title_commander
				has_job_title = job_marshal
				has_job_title = job_chancellor
				has_job_title = job_treasurer
				has_job_title = job_spymaster
				has_job_title = job_spiritual
			}
			mercenary = no
			holy_order = no
			is_landed = yes
			OR = {
				independent = yes
				ai = no
			}
		}

		allow = {
			offmap_dwse= {
			}
			FROM = {
				show_scope_change = no
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
				NOT = {
					has_character_flag = dragon_am_send
				}		
			}
		}
		
		third_party_potential = {
			FROMFROM = {
				show_scope_change = no
				is_child_of = FROMFROM
				is_adult = yes
				is_female = yes
				prisoner = no
				NOT = { has_character_flag = previous_dragon_ambassador }
			}
		}

		third_party_allow = {
			FROMFROM = {
				is_pregnant = no
				host = { character = FROMFROM }
				is_not_enslaved = yes
				fertility = 0.01
				NOR = { 
					trait = dwse_shapeshifted
					trait = dragon_pregnancy
					trait = dwse_lizard_pregnancy
					is_inaccessible_trigger = yes
					trait = lf_ghost
					practical_age >= 45
					trait = tentacle_pregnancy
					trait = dragon_ambassador
					trait = lf_asexual
				}			
				custom_tooltip = {
					text = is_not_incapable_inbred_or_imbecile_tt
					NOT = { trait = incapable }
					NOT = { trait = inbred }
					NOT = { trait = imbecile }
				}
				custom_tooltip = {
					text = is_not_maimed_or_infirm_tt
					NOT = { trait = maimed }
					NOT = { trait = infirm }
				}
			}
		}
		effect = {
			FROM = {
				narrative_event = { id = dwseom.3000 days = 1 }
				set_character_flag = dragon_am_send
			}
		}
	
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.3 # slow down
			}
		}
	}
	dwse_sell_prisoner = {
		only_playable = yes
		button_name = dwse_gifts
		
		third_party_filter = home_court
		ai_third_party_filter = home_court
		third_party = FROM
		ai_check_interval = 36
		show_third_party_potential = yes

		potential = {
			is_offmap_tag = offmap_dwse	
		}
	
		from_potential = {
			lf_races_dwse_active = yes
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			offmap_dwse= {
			}
			FROM = {
				show_scope_change = no
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
		}
		
		third_party_potential = {
			FROMFROM = {
				NOT = { is_incapable = yes }
				ai = yes
				show_scope_change = no
				prisoner = yes
				host = { character = FROMFROM }
				is_not_enslaved = yes
				NOT = { trait = lf_ghost }
				custom_tooltip = {
					text = is_not_incapable_inbred_or_imbecile_tt
					NOT = { trait = incapable }
					NOT = { trait = inbred }
					NOT = { trait = imbecile }
				}
				custom_tooltip = {
					text = is_not_maimed_or_infirm_tt
					NOT = { trait = maimed }
					NOT = { trait = infirm }
				}				
			}
		}

		third_party_allow = {
			FROMFROM = {
				prisoner = yes
				host = { character = FROMFROM }
				is_ill = no
				custom_tooltip = {
					text = is_not_wounded_severely_injured_tt
					NOT = { trait = wounded }
					NOT = { trait = severely_injured }
				}
				custom_tooltip = {
					text = lf_too_important_for_dragons_tt
					NOT = { has_character_flag = lf_too_important_for_dragons }
				}
				is_inaccessible_trigger = no
			}
		}
		
		third_party_score = {
			factor = 100
			
			additive_modifier = {
				value = -20
				FROM = {
					show_scope_change = no
					NOR = { 
						capital_holding = {
							OR = {
								has_building = dwse_dragon_roost_castle
								has_building = dwse_dragon_roost_tribal
								has_building = dwse_dragon_roost_nomad
							}
						}
						family_palace = {
							has_building = dwse_dragon_roost_palace
						}
 					}
				}
			}

			additive_modifier = {
				value = 15
				FROMFROM = { 
					show_scope_change = no
					is_heir = yes
				}
			}
			additive_modifier = {
				value = 15
				FROMFROM = { 
					show_scope_change = no
					is_landed = yes 
				}
			}
			additive_modifier = {
				value = -25
				FROMFROM = { 
					show_scope_change = no
					is_adult = no
				}
			}

			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_neko = yes
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_futa = yes
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_elf = yes
				}
			}
			additive_modifier = {
				value = 100
				FROMFROM = { 
					show_scope_change = no
					is_orc = yes
				}
			}
						additive_modifier = {
				value = 10
				FROMFROM = { 
					show_scope_change = no
					is_female = yes
				}
			}
			modifier = {
				factor = 2.0
				FROMFROM = { 
					show_scope_change = no
					liked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
			modifier = {
				factor = 0.5
				FROMFROM = {
					show_scope_change = no 
					disliked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					show_scope_change = no
					liked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
			modifier = {
				factor = 0.66
				FROM = {
					show_scope_change = no 
					disliked_by_offmap = {
						type = offmap_dwse
					}
				}
			}
		}
	
		effect = {
			save_event_target_as = target_governor
			FROM = {
				sound_effect = china_grace_gain
				save_event_target_as = target_tribute_sender
			}
			FROMFROM = {
				save_event_target_as = person_sent_as_tribute
			}
			#if = {
			#	limit = {
			#		FROMFROM = { disliked_by_offmap = offmap_dwse}
			#	}
			#	custom_tooltip = { text = notification_china_dislike_tt }
			#}
			#if = {
			#	limit = {
			#		NOT = { FROMFROM = { disliked_by_offmap = offmap_dwse} }
			#		FROMFROM = { liked_by_offmap = offmap_dwse}
			#	}
			#	custom_tooltip = { text = notification_china_like_tt }
			#}
			FROM = {
				show_scope_change = no
				add_offmap_currency = {
					offmap = offmap_dwse
					value = local_third_party_score
				}
			}
			
			# Like/Dislike effect description
			#################################
			if = {
				limit = {
					OR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
					NOR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
				}
				e_offmap_dwse_voice = {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = likes_tt }
					}
				}
			}
			
			if = {
				limit = {
					OR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
					NOR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
				}
				e_offmap_dwse_voice= {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = dislikes_tt }
					}
				}
			}
			if = {
				limit = {
					OR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
					OR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_dwse
							}
						}
					}
				}
				e_offmap_dwse_voice= {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = likes_but_dislikes_tt }
					}
				}
			}
			#################################
			
			FROMFROM = {
				show_scope_change = no
				leave_court_for_forest_effect = yes
			}
		}
	
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 0
				FROMFROM = { ai = no }
			}
		}
	}

	dwse__slavef = {
		only_playable = yes
		button_name = dwse_boons
		ai_check_interval = 12
		ai = no

		from_potential = {
			NOT = {
				has_dwse_no_empire = yes
			}
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_dwse
		}

#		potential = {
#			offmap_dwse = { governor = { character = ROOT } }
#		}

		allow = {
			FROM = {			
				show_scope_change = no
				has_offmap_currency = { offmap = offmap_dwse value = 250 }
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}

		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = china_grace_spend
				add_offmap_currency = {
					offmap = offmap_dwse
					value = -250
				}
			}
			hidden_effect = { offmap_dwse = { governor = { character_event = { id = dwseom.2 } } } }
		}


		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}
	dwse__slavem = {
		only_playable = yes
		button_name = dwse_boons
		ai_check_interval = 12
		ai = no

		from_potential = {
			lf_races_dwse_active = yes
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_dwse
		}

#		potential = {
#			offmap_dwse = { governor = { character = ROOT } }
#		}

		allow = {
			FROM = {			
				show_scope_change = no
				has_offmap_currency = { offmap = offmap_dwse value = 250 }
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}

		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = china_grace_spend
				add_offmap_currency = {
					offmap = offmap_dwse
					value = -250
				}
			}
			hidden_effect = { offmap_dwse = { governor = { character_event = { id = dwseom.3 } } } }
		}


		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}
	dwse__slavefe = {
		only_playable = yes
		button_name = dwse_boons
		ai_check_interval = 12
		ai = no

		from_potential = {
			OR = {
				lf_races_fareast_active = yes
				lf_races_fae_active = yes
			}
			lf_races_dwse_active = yes
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_dwse
		}

#		potential = {
#			offmap_dwse = { governor = { character = ROOT } }
#		}

		allow = {
			FROM = {
				show_scope_change = no				
				has_offmap_currency = { offmap = offmap_dwse value = 1000 }
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}

		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = china_grace_spend
				add_offmap_currency = {
					offmap = offmap_dwse
					value = -1000
				}
			}
			hidden_effect = { offmap_dwse = { governor = { character_event = { id = dwseom.4 } } } }
		}


		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}
	dwse__slaveme = {
		only_playable = yes
		button_name = dwse_boons
		ai_check_interval = 12
		ai = no

		from_potential = {
			OR = {
				lf_races_fareast_active = yes
				lf_races_fae_active = yes
			}
			lf_races_dwse_active = yes
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_dwse
		}

#		potential = {
#			offmap_dwse = { governor = { character = ROOT } }
#		}

		allow = {
			FROM = {
				show_scope_change = no
				has_offmap_currency = { offmap = offmap_dwse value = 750 }
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}

		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = china_grace_spend
				add_offmap_currency = {
					offmap = offmap_dwse
					value = -750
				}
			}
			hidden_effect = { offmap_dwse = { governor = { character_event = { id = dwseom.5 } } } }
		}


		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}

	dwse_slave_war = {
		only_playable = yes
		button_name = dwse_boons
		ai_check_interval = 12
		ai = no

		from_potential = {
			NOT = {
				has_character_modifier = dwse_war
			}
			lf_races_dwse_active = yes
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_dwse
		}

#		potential = {
#			offmap_dwse = { governor = { character = ROOT } }
#		}

		allow = {
			FROM = {
				show_scope_change = no
				lf_has_slaves = yes
				OR = {
					capital_holding = {
						OR = {
							has_building = dwse_dragon_roost_castle
							has_building = dwse_dragon_roost_tribal
							has_building = dwse_dragon_roost_nomad
						}
					}
					family_palace = {
						has_building = dwse_dragon_roost_palace
					}
				}
				has_offmap_currency = { offmap = offmap_dwse value = 1000 }
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}

		}

		effect = {
			FROM = {
				add_character_modifier = { name = dwse_war years = 5 }	
				show_scope_change = no
				sound_effect = china_grace_spend
				add_offmap_currency = {
					offmap = offmap_dwse
					value = -1000
				}
			}
		}

		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}

	dragon_festival = {
		only_playable = yes
		button_name = dwse_gifts
		ai_check_interval = 100
		
		from_potential = {
			NOT = { is_incapable = yes }
			lf_races_dwse_active = yes
			is_adult = yes
			is_female = yes
			is_ruler = yes
			OR = {
				independent = yes
				ai = no
			}
			practical_age < 45
			NOR = {
				has_character_flag = previous_dragon_ambassador
				trait = tentacle_pregnancy
				trait = dwse_dragon_adult
				trait = dwse_shapeshifted
				trait = dragon_pregnancy
				trait = dwse_lizard_pregnancy
				trait = lf_ghost
				is_pregnant = yes
				has_character_modifier = dragon_festival_modifier 
				has_minor_title = title_commander
				has_job_title = job_marshal
				has_job_title = job_chancellor
				has_job_title = job_treasurer
				has_job_title = job_spymaster
				has_job_title = job_spiritual
				is_inaccessible_trigger = yes
			} 
		}
		
		potential = {
			is_offmap_tag = offmap_dwse
		}
		
		allow = {
			FROM = {
				show_scope_change = no
				war = no
				fertility = 0.01
				custom_tooltip = {
					text = health_travel_condition
					NOT = { trait = lf_asexual }
					hidden_tooltip = {
						NOR = {
							trait = dragon_pregnancy
							trait = pregnant
							trait = incapable
							trait = blinded
							trait = has_tuberculosis
							trait = has_typhoid_fever
							trait = has_typhus
							trait = has_bubonic_plague
							trait = has_measles
							trait = has_small_pox
							trait = has_aztec_disease
						}
					}
				}
			}
		}
		
		effect = {
			FROM = {
				narrative_event = {
					id = dwseom.500
				}
			}
		}
		
		ai_will_do ={
			factor = 1
			modifier = {
				factor = 0.01 #slow down
			}
		}
	}
	return_dragon_egg = {
		only_playable = yes
		button_name = dwse_gifts
		ai_check_interval = 100
		
		from_potential = {
			lf_races_dwse_active = yes
			has_artifact = dwse_dragon_egg
		}
		
		potential = {
			is_offmap_tag = offmap_dwse
		}
		
		allow = {
			FROM = {
				show_scope_change = no
				NOT = { is_incapable = yes }
				OR = {
					capital_holding = {
						OR = {
							has_building = dwse_dragon_roost_castle
							has_building = dwse_dragon_roost_tribal
							has_building = dwse_dragon_roost_nomad
						}
					}
					family_palace = {
						has_building = dwse_dragon_roost_palace
					}
				}
				war = no
			}
		}
		
		effect = {
			FROM = {
				narrative_event = {
					id = dwseom.700
				}
			}
		}
		
		ai_will_do ={
			factor = 1
		}
	}
}

targetted_decisions = {

	dwse_boink_dragon = {
		filter = realm
		ai_target_filter = none
		ai = no
		from_potential = {
			NOT = {	trait = dwse_dragon_adult }
			NOT = { is_incapable = yes }
			is_female = yes
			is_adult = yes
			is_pregnant = no
			OR = {
				has_minor_title = dwse_weyrleader
				trait = dwse_dragonslut
			}
			prisoner = no
			lf_has_nsfw = yes
			ai = no
		}
		potential = {
			trait = dwse_dragon_adult
			NOT = { is_incapable = yes }
			NOT = { trait = dwse_shapeshifted }
			is_female = no
			prisoner = no
		}
		allow = {
			ROOT = {
				OR = {
					at_location = FROM
					same_realm = FROM
				}
			}
			FROM = {
				custom_tooltip = { # The target shouldn't have been visited within the past month
					text = lf_visit_recovery_loc
					OR = {
						NOT = { has_character_modifier = lf_sex_recovery }
						trait = lf_insatiable
					}
				}
			}
		}
		effect = {
			# adding to the insatiable counter
			FROM = {
				character_event = { id = LFSexytimesRouting.12 }
			}
			# Saving event targets
			save_event_target_as = lf_sex_partner
			FROM = { 
				save_event_target_as = lf_sex_player
			}
			# Only one visit per month, just to keep things reasonable, sets on the target
			FROM = {
				if = {
					limit = {
						NOT = { trait = lf_insatiable }
					}
					add_character_modifier = {
						name = lf_sex_recovery
						duration = 30
					}
				}
			}
			# Initiate visit event
			hidden_tooltip = {
				FROM = {
					character_event = { id = LFSexytimesFramework.1 }
				}
			}
		}
	}
	
	dwse_boink_humanoid = {
		filter = realm
		ai_target_filter = none
		ai = no
		from_potential = {
			trait = dwse_dragon_adult
			NOT = { is_incapable = yes }
			NOT = { trait = dwse_shapeshifted }
			is_female = no
			lf_has_nsfw = yes
			prisoner = no
			ai = no
		}
		potential = {
			is_female = yes
			is_adult = yes
			is_pregnant = no
			OR = {
				has_minor_title = dwse_weyrleader
				trait = dwse_dragonslut
			}
			NOT = { is_incapable = yes }
			NOT = {	trait = dwse_dragon_adult }
			prisoner = no
		}
		allow = {
			ROOT = {
				custom_tooltip = {
					text = is_not_busy_trigger_tooltip
					NOR = {
						in_seclusion = yes
						has_character_flag = do_not_disturb
						is_inaccessible_trigger = yes
					}
				}
				OR = {
					at_location = FROM
					same_realm = FROM
				}
			}
			FROM = {
				custom_tooltip = {
					text = is_not_busy_trigger_tooltip
					NOR = {
						in_seclusion = yes
						has_character_flag = do_not_disturb
						is_inaccessible_trigger = yes
					}
				}
				custom_tooltip = { # The target shouldn't have been visited within the past month
					text = lf_visit_recovery_loc
					OR = {
						NOT = { has_character_modifier = lf_sex_recovery }
						trait = lf_insatiable
					}
				}
			}
		}
		effect = {
			# adding to the insatiable counter
			FROM = {
				character_event = { id = LFSexytimesRouting.12 }
			}
			# Saving event targets
			save_event_target_as = lf_sex_partner
			FROM = { 
				save_event_target_as = lf_sex_player
			}
			# Only one visit per month, just to keep things reasonable, sets on the target
			FROM = {
				if = {
					limit = {
						NOT = { trait = lf_insatiable }
					}
					add_character_modifier = {
						name = lf_sex_recovery
						duration = 30
					}
				}
			}
			# Initiate visit event
			hidden_tooltip = {
				FROM = {
					character_event = { id = LFSexytimesFramework.1 }
				}
			}
		}
	}		

	dwse_dragon_shapeshift_human = {
		filter = self
		ai_target_filter = none
		ai_check_interval = 48
		ai = no
		potential = {
			NOT = { is_incapable = yes }
			ai = no
			trait = dwse_dragon_adult
		}
		allow = {
			NOR = {
				trait = dragon_pregnancy
				trait = dwse_lizard_pregnancy
				trait = tentacle_pregnancy
				is_pregnant = yes
			}
		}
		effect = {
			character_event = { id = DWSEDragon.1 }
		}
		ai_will_do = {
			factor = 0 # Originally 0.1
			modifier = {
				factor = 0
				OR = {
					trait = content # Content with current form
					trait = ambitious # Too ambitious to change
				}
			}
		}
	}
	dwse_dragon_shapeshift_human_revert = {
		filter = self
		ai_target_filter = none
		ai_check_interval = 48
		ai = no
		potential = {
			NOT = { is_incapable = yes }
			ai = no
			trait = dwse_shapeshifted
			NOT = { trait = dwse_lizard }
		}
		allow = {
			NOR = {
				trait = dragon_pregnancy
				trait = dwse_lizard_pregnancy
				trait = tentacle_pregnancy
				is_pregnant = yes
			}
		}
		effect = {
			character_event = { id = DWSEDragon.2 }
		}
		ai_will_do = {
			factor = 0 # Originally 0.1
			modifier = {
				factor = 0
				any_spouse = {
					NOT = { trait = dwse_dragon_adult }
				}
			}
		}
	}
	dwse_dragon_shapeshift_aura = {
		filter = self
		ai_target_filter = none
		ai_check_interval = 48
		ai = no
		potential = {
			NOT = { is_incapable = yes }
			trait = dwse_dragon_adult
			ai = no
		}
		allow = {
			NOR = {
				trait = dragon_pregnancy
				trait = dwse_lizard_pregnancy
				trait = tentacle_pregnancy
				is_pregnant = yes
			}
		}
		effect = {
			character_event = { id = DWSEDragon.3 }
		}
		ai_will_do = {
			factor = 0 # Originally 0.1
			modifier = {
				factor = 0
				OR = {
					trait = content # Content with current form
					trait = ambitious # Too ambitious to change
				}
			}
		}
	}
	dwse_dragon_shapeshift_aura_revert = {
		filter = self
		ai_target_filter = none
		ai_check_interval = 48
		ai = no
		potential = {
			NOT = { is_incapable = yes }
			ai = no
			trait = dwse_shapeshifted
			trait = dwse_lizard
		}
		allow = {
			NOR = {
				trait = dragon_pregnancy
				trait = dwse_lizard_pregnancy
				trait = tentacle_pregnancy
				is_pregnant = yes
			}
		}
		effect = {
			character_event = { id = DWSEDragon.4 }
		}
		ai_will_do = {
			factor = 0 # Originally 0.1
			modifier = {
				factor = 0
				any_spouse = {
					trait = dwse_lizard
				}
			}
		}
	}
		
		
	dragon_kidnap = {
		filter = all
		ai_target_filter = realm
		ai = no
		from_potential = {
			OR = {
				lf_races_dwse_active = yes
			}
			ai = no # Player only
			any_child = {
				NOT = { is_incapable = yes }
				trait = dwse_dragon_adult
				is_adult = yes
				is_alive = yes
				OR = {
					has_character_modifier = dragon_satisfied
					is_female = yes
				}
			}
		}
		potential = {
			NOR = { 
				diplomatic_immunity = yes 
				has_character_flag = lf_no_kidnap
				trait = dwse_dragon_adult 
			}
			prisoner = no
		}
		allow = {
			prisoner = no
			is_adult = yes
			FROM = {
				war = no
				has_focus = focus_intrigue
			}
		}
		effect = {
			FROM = { narrative_event = { id = dwseom.3800 }}
		}
		ai_will_do = {
			factor = 0 # Not wanting the ai to do this at this time
		}
	}
	dragon_leave = { # Dragonlings will die off if their mother dies and there is no weyrleader to take care of them.
		ai = yes
		ai_target_filter = self
		ai_check_interval = 6
		potential = {
			ai = yes
			NOT = {
				has_character_flag = dragon_leaving	
			}
			trait = dwse_dragon_child
			mother_even_if_dead = {
				is_alive = no
			}
			is_ruler = no
			NOT = {
				any_courtier_or_vassal = {
					has_minor_title = dwse_weyrleader
				}
			}
		}
		allow = {
			always = yes # For our testing purposes
		}
		effect = {
			set_character_flag = dragon_leaving
			set_character_flag = lf_never_turn_spoopy
			death = { death_reason = death_dwse_starvation }
		}
		ai_will_do = {
			factor = 0.75 
		}
	}
}
